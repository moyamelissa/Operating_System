#!/bin/bash

echo "=============================================================="
echo "   COMPILATION ET EXÉCUTION - TP3 INF1429"
echo "=============================================================="
echo ""

# Vérifier si gcc est installé
if ! command -v gcc &> /dev/null; then
    echo "ERREUR: gcc n'est pas installé sur ce système"
    exit 1
fi

echo "=== COMPILATION DES SCRIPTS ==="
echo ""

# Compilation du script de segmentation
echo "[1/3] Compilation de segmentation. c..."
gcc -o segmentation segmentation.c -Wall -Wextra
if [ $? -eq 0 ]; then
    echo "      ✓ segmentation.c compilé avec succès"
else
    echo "      ✗ Erreur de compilation de segmentation. c"
    exit 1
fi

# Compilation du script de pagination
echo "[2/3] Compilation de pagination.c..."
gcc -o pagination pagination.c -Wall -Wextra
if [ $? -eq 0 ]; then
    echo "      ✓ pagination.c compilé avec succès"
else
    echo "      ✗ Erreur de compilation de pagination. c"
    exit 1
fi

# Compilation du script d'observation
echo "[3/3] Compilation de observation_memoire.c..."
gcc -o observation_memoire observation_memoire.c -Wall -Wextra
if [ $? -eq 0 ]; then
    echo "      ✓ observation_memoire.c compilé avec succès"
else
    echo "      ✗ Erreur de compilation de observation_memoire.c"
    exit 1
fi

echo ""
echo "=== TOUS LES SCRIPTS ONT ÉTÉ COMPILÉS AVEC SUCCÈS ==="
echo ""
echo "=============================================================="
echo ""

# Exécution des scripts
echo "=== EXÉCUTION DES SCRIPTS ==="
echo ""

echo ">>> PROBLÈME 1: SEGMENTATION <<<"
echo ""
./segmentation
echo ""
echo "Appuyez sur Entrée pour continuer..."
read

echo ""
echo "=============================================================="
echo ""
echo ">>> PROBLÈME 2: PAGINATION <<<"
echo ""
./pagination
echo ""
echo "Appuyez sur Entrée pour continuer..."
read

echo ""
echo "=============================================================="
echo ""
echo ">>> OBSERVATION DE LA MÉMOIRE RÉELLE <<<"
echo ""
./observation_memoire
echo ""

echo "=============================================================="
echo "               TOUS LES SCRIPTS ONT ÉTÉ EXÉCUTÉS"
echo "=============================================================="
